{
    "version": "7.2",
    "data_api_version": "3.0",
    "routing_model": {
        "DEVICE_SELECTION": [
            "PLAN_SELECTION"
        ],
        "PLAN_SELECTION": [
            "IMEI_VALIDATION"
        ],
        "IMEI_VALIDATION": [
            "CLIENT_DATA"
        ],
        "CLIENT_DATA": [
            "ORDER_SUMMARY"
        ]
    },
    "screens": [
        {
            "id": "DEVICE_SELECTION",
            "title": "Dados do Aparelho",
            "data": {
                "brands": {
                    "type": "array",
                    "items": {
                        "type": "object",
                        "properties": {
                            "id": {"type": "string"},
                            "title": {"type": "string"}
                        }
                    },
                    "__example__": [
                        {"id": "APPLE", "title": "Apple"},
                        {"id": "SAMSUNG", "title": "Samsung"}
                    ]
                },
                "models": {
                    "type": "array",
                    "items": {
                        "type": "object",
                        "properties": {
                            "id": {"type": "string"},
                            "title": {"type": "string"}
                        }
                    },
                    "__example__": []
                },
                "memories": {
                    "type": "array",
                    "items": {
                        "type": "object",
                        "properties": {
                            "id": {"type": "string"},
                            "title": {"type": "string"}
                        }
                    },
                    "__example__": []
                },
                "selected_brand": {
                    "type": "string",
                    "__example__": ""
                },
                "selected_model": {
                    "type": "string",
                    "__example__": ""
                },
                "selected_memory": {
                    "type": "string",
                    "__example__": ""
                },
                "device_id": {
                    "type": "string",
                    "__example__": ""
                }
            },
            "layout": {
                "type": "SingleColumnLayout",
                "children": [
                    {
                        "type": "TextHeading",
                        "text": "Seguro do Celular"
                    },
                    {
                        "type": "TextBody",
                        "text": "Informe os dados do celular que deseja segurar:"
                    },
                    {
                        "type": "Dropdown",
                        "name": "brand",
                        "label": "Marca do Celular",
                        "required": true,
                        "data-source": "${data.brands}",
                        "on-select-action": {
                            "name": "data_exchange",
                            "payload": {
                                "selected_brand": "${form.brand}"
                            }
                        }
                    },
                    {
                        "type": "Dropdown",
                        "name": "model",
                        "label": "Modelo",
                        "required": true,
                        "data-source": "${data.models}",
                        "on-select-action": {
                            "name": "data_exchange",
                            "payload": {
                                "selected_brand": "${form.brand}",
                                "selected_model": "${form.model}"
                            }
                        }
                    },
                    {
                        "type": "Dropdown",
                        "name": "memory",
                        "label": "Memória",
                        "required": true,
                        "data-source": "${data.memories}",
                        "on-select-action": {
                            "name": "data_exchange",
                            "payload": {
                                "selected_brand": "${form.brand}",
                                "selected_model": "${form.model}",
                                "selected_memory": "${form.memory}"
                            }
                        }
                    },
                    {
                        "type": "Footer",
                        "label": "Continuar",
                        "on-click-action": {
                            "name": "data_exchange",
                            "payload": {
                                "device_id": "${data.device_id}",
                                "brand": "${form.brand}",
                                "model": "${form.model}",
                                "memory": "${form.memory}",
                                "navigate_to": "PLAN_SELECTION"
                            }
                        }
                    }
                ]
            }
        },
        {
            "id": "PLAN_SELECTION",
            "title": "Escolha seu Plano",
            "data": {
                "device_model": {
                    "type": "string",
                    "__example__": "IPHONE 16 PRO"
                },
                "device_memory": {
                    "type": "string",
                    "__example__": "128GB"
                },
                "device_price": {
                    "type": "string",
                    "__example__": "R$ 7.999,00"
                },
                "selected_plan_name": {
                    "type": "string",
                    "__example__": "SUPER ECON\u00d4MICO"
                },
                "price_display": {
                    "type": "array",
                    "items": {
                        "type": "object",
                        "properties": {
                            "id": {"type": "string"},
                            "title": {"type": "string"},
                            "description": {"type": "string"}
                        }
                    },
                    "__example__": [
                        {
                            "id": "price",
                            "title": "Valor mensal de R$ 19,90",
                            "description": "SUPER ECONÔMICO"
                        }
                    ]
                }
            },
            "layout": {
                "type": "SingleColumnLayout",
                "children": [
                    {
                        "type": "TextHeading",
                        "text": "Escolha seu Plano"
                    },
                    {
                        "type": "RadioButtonsGroup",
                        "name": "plan",
                        "label": "Escolha o Plano",
                        "required": true,
                        "on-select-action": {
                            "name": "data_exchange",
                            "payload": {
                                "selected_plan": "${form.plan}",
                                "franchise": "${form.franchise}",
                                "billing_type": "${form.billing_type}"
                            }
                        },
                        "data-source": [
                            {
                                "id": "super_economico",
                                "title": "SUPER ECONÔMICO",
                                "description": "Danos Acidentais por Queda e Líquido"
                            },
                            {
                                "id": "economico",
                                "title": "ECONÔMICO",
                                "description": "Roubo, Furto Simples e Qualificado"
                            },
                            {
                                "id": "completo",
                                "title": "COMPLETO",
                                "description": "Danos Acidentais por Queda e Líquido\nRoubo, Furto Simples e Qualificado"
                            }
                        ]
                    },
                    {
                        "type": "RadioButtonsGroup",
                        "name": "franchise",
                        "label": "Escolha a franquia *",
                        "required": true,
                        "on-select-action": {
                            "name": "data_exchange",
                            "payload": {
                                "selected_plan": "${form.plan}",
                                "franchise": "${form.franchise}",
                                "billing_type": "${form.billing_type}"
                            }
                        },
                        "data-source": [
                            {
                                "id": "normal",
                                "title": "Normal"
                            },
                            {
                                "id": "reduzida",
                                "title": "Reduzida (+15%)"
                            }
                        ]
                    },
                    {
                        "type": "TextCaption",
                        "text": "*Valor pago pelo segurado em caso de danos, furto ou roubo antes da cobertura da seguradora."
                    },
                    {
                        "type": "RadioButtonsGroup",
                        "name": "billing_type",
                        "label": "Escolha a forma de cobrança",
                        "required": true,
                        "on-select-action": {
                            "name": "data_exchange",
                            "payload": {
                                "selected_plan": "${form.plan}",
                                "franchise": "${form.franchise}",
                                "billing_type": "${form.billing_type}"
                            }
                        },
                        "data-source": [
                            {
                                "id": "anual",
                                "title": "Anual",
                                "description": "Cobertura internacional\nAnálise, aprovação e proteção IMEDIATA\nAtendimento 24 horas"
                            },
                            {
                                "id": "mensal",
                                "title": "Mensal *",
                                "description": "Cobertura internacional\nAnálise, aprovação e proteção IMEDIATA\nAtendimento 24 horas"
                            }
                        ]
                    },
                    {
                        "type": "TextCaption",
                        "text": "*Não utiliza todo limite do seu cartão de crédito"
                    },
                    {
                        "type": "TextSubheading",
                        "text": "Valor Final"
                    },
                    {
                        "type": "RadioButtonsGroup",
                        "name": "price_summary",
                        "label": "Resumo do Valor",
                        "required": false,
                        "data-source": "${data.price_display}",
                        "init-value": "price"
                    },
                    {
                        "type": "Footer",
                        "label": "Continuar",
                        "on-click-action": {
                            "name": "navigate",
                            "next": {
                                "type": "screen",
                                "name": "IMEI_VALIDATION"
                            },
                            "payload": {}
                        }
                    }
                ]
            }
        },
        {
            "id": "IMEI_VALIDATION",
            "title": "Validação do IMEI",
            "data": {
                "imei_error": {
                    "type": "string",
                    "__example__": ""
                },
                "is_validating": {
                    "type": "boolean",
                    "__example__": false
                }
            },
            "layout": {
                "type": "SingleColumnLayout",
                "children": [
                    {
                        "type": "TextHeading",
                        "text": "Validação do IMEI"
                    },
                    {
                        "type": "TextBody",
                        "text": "Digite o IMEI do seu aparelho para validação."
                    },
                     {
                        "type": "TextCaption",
                        "text": "Para encontrar o IMEI: disque *#06# no seu celular ou veja na caixa do aparelho."
                    },
                    {
                        "type": "TextInput",
                        "name": "imei",
                        "label": "IMEI",
                        "input-type": "number",
                        "required": true,
                        "helper-text": "Digite apenas 15 números",
                        "error-message": "${data.imei_error}"
                    },
                    {
                        "type": "Footer",
                        "label": "Validar IMEI",
                        "on-click-action": {
                            "name": "data_exchange",
                            "payload": {
                                "imei": "${form.imei}",
                                "validate_imei": true
                            }
                        }
                    }
                ]
            }
        },
        {
            "id": "CLIENT_DATA",
            "title": "Dados do Cliente",
            "data": {},
            "layout": {
                "type": "SingleColumnLayout",
                "children": [
                    {
                        "type": "TextHeading",
                        "text": "Dados do Cliente"
                    },
                    {
                        "type": "TextBody",
                        "text": "Preencha os dados básicos do segurado:"
                    },
                    {
                        "type": "TextInput",
                        "name": "full_name",
                        "label": "Nome Completo",
                        "input-type": "text",
                        "required": true,
                        "helper-text": "Nome conforme documento"
                    },
                    {
                        "type": "TextInput",
                        "name": "cpf",
                        "label": "CPF",
                        "input-type": "text",
                        "required": true,
                        "helper-text": "Digite apenas números"
                    },
                    {
                        "type": "TextInput",
                        "name": "email",
                        "label": "E-mail",
                        "input-type": "email",
                        "required": true,
                        "helper-text": "Para envio da apólice"
                    },
                    {
                        "type": "TextInput",
                        "name": "phone",
                        "label": "Telefone",
                        "input-type": "phone",
                        "required": true,
                        "helper-text": "Digite com DDD"
                    },
                    {
                        "type": "DatePicker",
                        "name": "birth_date",
                        "label": "Data de Nascimento",
                        "required": true
                    },
                    {
                        "type": "Footer",
                        "label": "Continuar",
                        "on-click-action": {
                            "name": "navigate",
                            "next": {
                                "type": "screen",
                                "name": "ORDER_SUMMARY"
                            },
                            "payload": {}
                        }
                    }
                ]
            }
        },
        {
            "id": "ORDER_SUMMARY",
            "title": "Resumo do Pedido",
            "terminal": true,
            "data": {
                "summary": {
                    "type": "object",
                    "properties": {
                        "device": {"type": "string"},
                        "plan": {"type": "string"},
                        "total": {"type": "string"},
                        "total_pix": {"type": "string"}
                    },
                    "__example__": {
                        "device": "IPHONE 16 PRO - 128GB",
                        "plan": "COMPLETO - R$ 49,90",
                        "total": "R$ 49,90",
                        "total_pix": "R$ 47,40"
                    }
                }
            },
            "layout": {
                "type": "SingleColumnLayout",
                "children": [
                    {
                        "type": "TextHeading",
                        "text": "RESUMO DO PEDIDO"
                    },
                    {
                        "type": "TextSubheading",
                        "text": "Aparelho"
                    },
                    {
                        "type": "TextBody",
                        "text": "${data.summary.device}"
                    },
                    {
                        "type": "TextSubheading",
                        "text": "Plano Selecionado"
                    },
                    {
                        "type": "TextBody",
                        "text": "${data.summary.plan}"
                    },
                    {
                        "type": "TextBody",
                        "text": "─────────────────────────"
                    },
                    {
                        "type": "TextSubheading",
                        "text": "Total: ${data.summary.total}"
                    },
                    {
                        "type": "TextBody",
                        "text": "PIX com 5% desconto: ${data.summary.total_pix}"
                    },
                    {
                        "type": "TextBody",
                        "text": "3x sem juros no cartão"
                    },
                    {
                        "type": "TextCaption",
                        "text": "- Cobertura imediata após pagamento\n- Cancelamento sem multa\n- Aparelho reserva em 24h"
                    },
                    {
                        "type": "Footer",
                        "label": "Confirmar e Contratar",
                        "on-click-action": {
                            "name": "complete",
                            "payload": {
                                "brand": "${screen.DEVICE_SELECTION.form.brand}",
                                "model": "${screen.DEVICE_SELECTION.form.model}",
                                "memory": "${screen.DEVICE_SELECTION.form.memory}",
                                "device_id": "${screen.DEVICE_SELECTION.data.device_id}",
                                "plan": "${screen.PLAN_SELECTION.form.plan}",
                                "client_name": "${screen.CLIENT_DATA.form.full_name}",
                                "client_cpf": "${screen.CLIENT_DATA.form.cpf}",
                                "client_email": "${screen.CLIENT_DATA.form.email}",
                                "client_phone": "${screen.CLIENT_DATA.form.phone}",
                                "client_birth_date": "${screen.CLIENT_DATA.form.birth_date}"
                            }
                        }
                    }
                ]
            }
        }
    ]
}
